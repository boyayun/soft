<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Kinetis-M Peripheral Bare-Metal Drivers: AIPS Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="drivers.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="fsl_logo.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Kinetis-M Peripheral Bare-Metal Drivers
   &#160;<span id="projectnumber">EAR2.2</span>
   </div>
   <div id="projectbrief">Reference Manual</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="pages.html"><span>Pages</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__aips__example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AIPS Example<div class="ingroups"><a class="el" href="group__aips__drv.html">AIPS Driver</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This example demonstrates typical use of the Peripheral Bridge (AIPS) driver to manage all bus master transactions ("bus cycles") destined for the attached slave devices. The Peripheral Bridge (AIPS) is programmable only in privileged secure mode. Each peripheral slot supports read and write protection definition for bus masters and privileged secure and user secure/non-secure modes.</p>
<p>The software example demonstrates LPTMR slot being configured for read and write access from software running in privileged secure mode only. Therefore any attempts to access LPTMR registers from software running either in user secure or user non-secure modes are not allowed and generate Hard Fault. </p>
<dl class="section user"><dt>Source code:</dt><dd><div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * (c) Copyright 2010-2013, Freescale Semiconductor Inc.</span></div>
<div class="line"><span class="comment"> * ALL RIGHTS RESERVED.</span></div>
<div class="line"><span class="comment"> ******************************************************************************</span></div>
<div class="line"><span class="comment"> * aips_test.c</span></div>
<div class="line"><span class="comment"> ******************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#include &quot;common.h&quot;</span>                                                           </div>
<div class="line"><span class="preprocessor">#include &quot;drivers.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">volatile</span> <a class="code" href="group__basic__data__types.html#gadf957e9fa8c95c188ffacb8197aa8725" title="signed 16 bits ">int16</a> counter;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> main (<span class="keywordtype">void</span>)</div>
<div class="line">{  </div>
<div class="line">  <span class="comment">/* enable clock to all peripherals                                          */</span></div>
<div class="line">  <a class="code" href="group__sim__macro.html#gaa18c82149801915ea85f8b112247449a" title="SIM initialization. ">SIM_Init</a> (<a class="code" href="group__sim__config.html#ga899efbad9c2c6af161201c24aafd9e71" title="Full configuration. ">SIM_MODULE_ALL_PERIPH_ON_CONFIG</a>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">/* Set bus masters attribute to be controlled internally by the core        */</span></div>
<div class="line">  <a class="code" href="group__mcm__macro.html#ga47929c404a1dc093779d3cee7e895635" title="Crossbar master access configuration and locking. ">MCM_SetMasterAttr</a> (<a class="code" href="group__mcm__master.html#ga7b783d1ef52de087dff72faed3eccf90" title="CM0 Core Master (port number 0) ">MCM_CM0_MASTER</a>|<a class="code" href="group__mcm__master.html#ga5f263caf9a820e1410608acced27ea3f" title="DMA Master (port number 2) ">MCM_DMA_MASTER</a>,</div>
<div class="line">                     <a class="code" href="group__mcm__master__attr.html#ga666b9dfe7009e0439aa7859f7943b854" title="Enable {privileged or user, secure or nonsecure}. ">MCM_MASTER_EN_PRIV_OR_USER_SECURE_OR_NONSEC</a>,</div>
<div class="line">                     TRUE);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">/* Set LPTMR slot for RW access from privileged secure mode - slot opened   */</span></div>
<div class="line">  <a class="code" href="group__aips__macro.html#gace56d54c823b76d1f448eb5f3a3b6315" title="Configures and locks access to peripheral(s) attributes. ">AIPS_SetSlotAttr</a> (<a class="code" href="group__aips__slot.html#gaf3fcac4c143078f88cf6e08561215df9" title="Slot 60: Low Power Timer (LPTMR) ">AIPS_LPTMR_SLOT</a>, <a class="code" href="group__aips__slot__attr.html#ga0f91f6d346d08c0bca07bfe55ab21137" title="User nonsecure=None, User secure=None, Privileged secure=Read/Write. ">AIPS_SLOT_NO_NO_RW</a>, TRUE); </div>
<div class="line">  </div>
<div class="line">  <a class="code" href="group__lptmr__macro.html#ga63b65401607d625bde32b8c7a2984bd2" title="LPTMR initialization. ">LPTMR_Init</a>(<a class="code" href="group__lptmr__config.html#ga717914bc28be48dc02d482b329463dc5" title="Timer mode selected and Timer operation is disabled after LPTMR_Init() function call. Timer counts in free running mode. ">LPTMR_MODULE_TIMER_FREERUN_MODE_CONFIG</a>(0,<a class="code" href="group__lptmr__clocks.html#gac260f3c8edbb573855b75f8c6f117e9e" title="Internal 1 KHz LPO clock. ">LPTMR_LPOCLK</a>),0);</div>
<div class="line">  <a class="code" href="group__lptmr__macro.html#ga642f2e40df5deba39d1f80df75005ac0" title="Resumes Timer operation. ">LPTMR_Enable</a>(); </div>
<div class="line">   </div>
<div class="line">  <span class="keywordflow">while</span>(1) </div>
<div class="line">  {</div>
<div class="line">    counter = <a class="code" href="group__lptmr__macro.html#gaec74987b64427c8eed7ed4165b4ea999" title="Returns Timer counter value. ">LPTMR_ReadCnt</a>();  <span class="comment">/* executes in privileged mode                */</span></div>
<div class="line">    <a class="code" href="group__cm0plus__macros.html#ga4b92ec23541c11e3109098f08983bcd3" title="Enters unprivileged (user) mode of execution. ">UserMode</a>();</div>
<div class="line">    counter = <a class="code" href="group__lptmr__macro.html#gaec74987b64427c8eed7ed4165b4ea999" title="Returns Timer counter value. ">LPTMR_ReadCnt</a>();  <span class="comment">/* hangs up in user mode                      */</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Appconfig.h:</dt><dd><div class="fragment"><div class="line"><span class="comment">/*****************************************************************************</span></div>
<div class="line"><span class="comment"> * (c) Copyright 2010, Freescale Semiconductor Inc.</span></div>
<div class="line"><span class="comment"> * ALL RIGHTS RESERVED.</span></div>
<div class="line"><span class="comment"> ***************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#ifndef __APPCONFIG_H</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define __APPCONFIG_H</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/***************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#define MCU_MKM34Z50</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/***************************************************************************/</span></div>
<div class="line"><span class="comment">//#define MTB_RAM_RESERVE</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/***************************************************************************/</span></div>
<div class="line"><span class="comment">//#define EMULATE_BME_IO_ACCESS</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/***************************************************************************/</span></div>
<div class="line"><span class="comment">/***************************************************************************/</span></div>
<div class="line"><span class="comment">/***************************************************************************/</span></div>
<div class="line"><span class="comment">/******************************************************************************/</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* __APPCONFIG_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Toolchain support:</dt><dd><table class="doxtable">
<tr>
<th align="center">IAR EWARM 6.5x</th><th align="center">CW MCU 10.x</th><th align="center">KEIL uVision 4.72</th><th align="center">CrossWorks 2.3.3  </th></tr>
<tr>
<td align="center">x </td><td align="center">x </td><td align="center"></td><td align="center">x </td></tr>
</table>
</dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Nov 4 2013 13:45:04 for Kinetis-M Peripheral Bare-Metal Drivers by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
